(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),c=a.n(s),i=a(7),r=a.n(i),o=(a(16),a(10)),l=a(2),u=c.a.createContext(),d=a.p+"static/media/logo.2e17206c.svg";function p(){return Object(n.jsx)("header",{className:"header",children:Object(n.jsx)("img",{className:"logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto Russia",src:d})})}var m=a(8),b=a(9),_=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(m.a)(this,e),this._baseUrl=a,this._headers=n}return Object(b.a)(e,[{key:"_fetchButCatch",value:function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():Promise.reject(new Error("".concat(e.status)))}))}},{key:"getUser",value:function(){return this._fetchButCatch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}},{key:"setUser",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}},{key:"setAvatar",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}},{key:"uploadCard",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}},{key:"getCards",value:function(){return this._fetchButCatch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}},{key:"deleteCard",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/cards/").concat(e._id),{method:"DELETE",headers:this._headers})}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.removeLike(e):this.setLike(e)}},{key:"setLike",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/cards/likes/").concat(e._id),{method:"PUT",headers:this._headers})}},{key:"removeLike",value:function(e){return this._fetchButCatch("".concat(this._baseUrl,"/cards/likes/").concat(e._id),{method:"DELETE",headers:this._headers})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-16",headers:{authorization:"25068d5b-79ef-423f-8b22-b9922c31ad6c","Content-Type":"application/json"}});function j(e){var t=e.card,a=e.onCardClick,s=e.onCardLike,i=e.onCardDelete,r=c.a.useContext(u),o=t.owner._id===r._id,l="card__delete-button ".concat(o?"card__delete-button_visible":"card__delete-button_hidden"),d=t.likes.some((function(e){return e._id===r._id})),p="card__like-button ".concat(d?"card__like-button_active":"");return Object(n.jsxs)("li",{className:"card",children:[Object(n.jsx)("img",{className:"card__image",src:t.link,alt:t.title,onClick:function(){a(t)}}),Object(n.jsx)("button",{className:l,type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){i(t)}}),Object(n.jsxs)("div",{className:"card__content",children:[Object(n.jsx)("h2",{className:"card__title",children:t.name}),Object(n.jsxs)("div",{children:[Object(n.jsx)("button",{className:p,type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){s(t)}}),Object(n.jsx)("p",{className:"card__likes",children:t.likes.length})]})]})]},t.key)}function h(e){var t=c.a.useContext(u);return Object(n.jsxs)("main",{className:"root__main",children:[Object(n.jsxs)("section",{className:"profile",children:[Object(n.jsxs)("div",{className:"profile__avatar",children:[Object(n.jsx)("img",{className:"profile__avatar-image",alt:"\u0410\u0432\u0430\u0442\u0430\u0440",src:t.avatar}),Object(n.jsx)("div",{className:"profile__avatar-edit",onClick:e.onEditAvatar})]}),Object(n.jsxs)("div",{className:"profile__profile-wrapper",children:[Object(n.jsxs)("div",{className:"profile__name-wrapper",children:[Object(n.jsx)("h1",{className:"profile__name",id:"profile__name",children:t.name}),Object(n.jsx)("button",{className:"profile__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",onClick:e.onEditProfile})]}),Object(n.jsx)("p",{className:"profile__description",id:"profile__description",children:t.about})]}),Object(n.jsx)("button",{className:"profile__add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:e.onAddPlace})]}),Object(n.jsx)("section",{className:"cards",children:Object(n.jsx)("ul",{className:"cards__items",children:e.cards&&e.cards.map((function(t){return Object(n.jsx)(j,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})}function f(){return Object(n.jsx)("footer",{className:"footer",children:Object(n.jsx)("p",{className:"footer__copyright",children:"\u0413\u0435\u043e\u0440\u0433\u0438\u0439 \u0413\u043e\u0440\u0447\u0435\u0432 \xa9 2020 Mesto Russia"})})}function O(e){var t=e.isOpen?"popup_opened":"";return Object(n.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(t),"data-type":"place",children:Object(n.jsxs)("form",{className:"popup__container",name:e.name,id:e.name,onSubmit:e.onSubmit,noValidate:!0,children:[Object(n.jsx)("h3",{className:"popup__title",children:e.title}),Object(n.jsxs)("fieldset",{className:"popup__form",form:e.name,children:[e.children,Object(n.jsx)("button",{className:"popup__save-button",type:"submit",children:e.isLoading?e.loadingText:e.submitButtonText})]}),Object(n.jsx)("button",{className:"popup__close-button",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose})]})})}function x(e){var t=e.card.link?"popup_opened":"",a=e.card.link?e.card.link:"#",s=e.card.name?e.card.name:"#";return Object(n.jsx)("div",{className:"popup popup_darkness_lightbox ".concat(t),"data-type":"lightbox",children:Object(n.jsxs)("figure",{className:"lightbox",children:[Object(n.jsx)("button",{className:"popup__close-button",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose}),Object(n.jsx)("img",{className:"lightbox__image",src:a,alt:s}),Object(n.jsx)("figcaption",{className:"lightbox__caption",children:s})]})})}function g(e){var t=e.isOpen,a=e.onClose,s=e.onUpdateUser,i=e.submitButtonText,r=e.loadingText,o=e.isLoading,d=c.a.useContext(u),p=c.a.useState(d.name),m=Object(l.a)(p,2),b=m[0],_=m[1],j=c.a.useState(d.name),h=Object(l.a)(j,2),f=h[0],x=h[1],g=d.name,v=d.name,C=c.a.useState(g),k=Object(l.a)(C,2),N=k[0],y=k[1],L=c.a.useState(v),S=Object(l.a)(L,2),T=S[0],U=S[1];return c.a.useEffect((function(){_(d.name),x(d.about)}),[d]),Object(n.jsx)(O,{name:"profle",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),s({name:N,about:T})},submitButtonText:i,loadingText:r,isLoading:o,children:Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"popup__form-item-group",children:[Object(n.jsx)("input",{id:"username",className:"popup__form-item popup__form-item_input_name",type:"text",placeholder:"\u0418\u043c\u044f",defaultValue:b,onChange:function(e){y(e.target.value)},name:"name",minLength:"2",maxLength:"40",required:!0}),Object(n.jsx)("span",{id:"username-error",className:"popup__form-error"})]}),Object(n.jsxs)("div",{className:"popup__form-item-group",children:[Object(n.jsx)("input",{id:"description",className:"popup__form-item popup__form-item_input_description",type:"text",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",defaultValue:f,onChange:function(e){return U(e.target.value)},name:"about",minLength:"2",maxLength:"200",required:!0}),Object(n.jsx)("span",{id:"description-error",className:"popup__form-error"})]})]})})}function v(e){var t=e.isOpen,a=e.onClose,s=e.onUpdateAvatar,i=c.a.useRef();return Object(n.jsx)(O,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),s(i.current.value)},children:Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"popup__form-item-group",children:[Object(n.jsx)("input",{ref:i,id:"link",className:"popup__form-item popup__form-item_input_name",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"link",required:!0}),Object(n.jsx)("span",{id:"link-error",className:"popup__form-error"})]})})})}var C=a(4);function k(e){var t=e.isOpen,a=e.onClose,s=e.submitButtonText,i=e.onAddPlace,r=e.loadingText,o=e.isLoading,u=c.a.useState({name:"",link:""}),d=Object(l.a)(u,2),p=d[0],m=d[1];function b(e){"title"===e.target.id?m(Object(C.a)(Object(C.a)({},p),{},{name:e.target.value})):m(Object(C.a)(Object(C.a)({},p),{},{link:e.target.value}))}return Object(n.jsx)(O,{name:"place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),i(p)},submitButtonText:s,loadingText:r,isLoading:o,children:Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"popup__form-item-group",children:[Object(n.jsx)("input",{id:"title",className:"popup__form-item popup__form-item_input_name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:function(e){return b(e)},name:"title",minLength:"1",maxLength:"30",required:!0}),Object(n.jsx)("span",{id:"title-error",className:"popup__form-error"})]}),Object(n.jsxs)("div",{className:"popup__form-item-group",children:[Object(n.jsx)("input",{id:"link",className:"popup__form-item popup__form-item_input_description",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:function(e){return b(e)},name:"link",required:!0}),Object(n.jsx)("span",{id:"link-error",className:"popup__form-error"})]})]})})}var N=function(){var e=c.a.useState({}),t=Object(l.a)(e,2),a=t[0],i=t[1],r=c.a.useState(!1),d=Object(l.a)(r,2),m=d[0],b=d[1],j=c.a.useState(!1),C=Object(l.a)(j,2),N=C[0],y=C[1],L=c.a.useState(!1),S=Object(l.a)(L,2),T=S[0],U=S[1],B=c.a.useState(!1),E=Object(l.a)(B,2),P=E[0],A=(E[1],c.a.useState({})),D=Object(l.a)(A,2),w=D[0],F=D[1],q=c.a.useState(!1),J=Object(l.a)(q,2),M=J[0],R=J[1],V=c.a.useState([]),H=Object(l.a)(V,2),I=H[0],z=H[1],G=function(){b(!1),y(!1),U(!1),F({})};return Object(s.useEffect)((function(){_.getCards().then((function(e){z(e)})).catch((function(e){return console.error("".concat(e,": \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438. \ud83d\udcdb"))}))}),[]),Object(s.useEffect)((function(){_.getUser().then((function(e){i(e)}),[])})),Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(u.Provider,{value:a,children:Object(n.jsxs)("div",{className:"root",children:[Object(n.jsx)(p,{}),Object(n.jsx)(h,{cards:I,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===a._id}));_.changeLikeCardStatus(e,t).then((function(t){var a=I.map((function(a){return a._id===e._id?t:a}));z(a)}))},onCardDelete:function(e){e.owner._id,a._id,_.deleteCard(e).then((function(){z(I.filter((function(t){return t._id!==e._id})))}))},onEditProfile:function(){b(!0)},onAddPlace:function(){y(!0)},onEditAvatar:function(){U(!0)},onCardClick:function(e){F(e)}}),Object(n.jsx)(f,{}),Object(n.jsx)(g,{isOpen:m,onClose:G,onUpdateUser:function(e){R(!0),console.log(e)},submitButtonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loadingText:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",isLoading:M}),Object(n.jsx)(v,{isOpen:T,onClose:G,onUpdateAvatar:function(e){_.setAvatar(e).then((function(e){i(e),G()}))}}),Object(n.jsx)(k,{isOpen:N,onClose:G,submitButtonText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loadingText:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435...",isLoading:M,onAddPlace:function(e){R(!0),_.uploadCard(e).then((function(e){z([e].concat(Object(o.a)(I))),G(),R(!1)}))}}),Object(n.jsx)(O,{name:"confirm-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:P,onClose:G,children:Object(n.jsx)("button",{className:"popup__save-button popup__save-button_context_confirm-delete",type:"submit",children:"\u0414\u0430"})}),Object(n.jsx)(x,{card:w,onClose:G})]})})})},y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),s(e),c(e),i(e)}))};r.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(N,{})}),document.getElementById("root")),y()}},[[17,1,2]]]);
//# sourceMappingURL=main.06c0cf5f.chunk.js.map